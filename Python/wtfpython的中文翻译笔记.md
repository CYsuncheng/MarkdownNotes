# wtfpythonçš„ä¸­æ–‡ç¿»è¯‘ç¬”è®°

## å¾®å¦™çš„å­—ç¬¦ä¸²

``` Python
# ä¾‹1
>>> a = "some_string"
>>> id(a)
140420665652016
>>> id("some" + "_" + "string") # æ³¨æ„ä¸¤ä¸ªçš„idå€¼æ˜¯ç›¸åŒçš„.
140420665652016

# ä¾‹2
>>> a = "wtf"
>>> b = "wtf"
>>> a is b
True

>>> a = "wtf!"
>>> b = "wtf!"
>>> a is b
False

>>> a, b = "wtf!", "wtf!"
>>> a is b
True

# ä¾‹3
>>> 'a' * 20 is 'aaaaaaaaaaaaaaaaaaaa'
True
>>> 'a' * 21 is 'aaaaaaaaaaaaaaaaaaaaa'
False
```

### è¯´æ˜
- è¿™äº›è¡Œä¸ºæ˜¯ç”±äº Cpython åœ¨ç¼–è¯‘ä¼˜åŒ–æ—¶, æŸäº›æƒ…å†µä¸‹ä¼šå°è¯•ä½¿ç”¨å·²ç»å­˜åœ¨çš„ä¸å¯å˜å¯¹è±¡è€Œä¸æ˜¯æ¯æ¬¡éƒ½åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡. (è¿™ç§è¡Œä¸ºè¢«ç§°ä½œå­—ç¬¦ä¸²çš„é©»ç•™[string interning])
- å‘ç”Ÿé©»ç•™ä¹‹å, è®¸å¤šå˜é‡å¯èƒ½æŒ‡å‘å†…å­˜ä¸­çš„ç›¸åŒå­—ç¬¦ä¸²å¯¹è±¡. (ä»è€ŒèŠ‚çœå†…å­˜)
- åœ¨ä¸Šé¢çš„ä»£ç ä¸­, å­—ç¬¦ä¸²æ˜¯éšå¼é©»ç•™çš„. ä½•æ—¶å‘ç”Ÿéšå¼é©»ç•™åˆ™å–å†³äºå…·ä½“çš„å®ç°. è¿™é‡Œæœ‰ä¸€äº›æ–¹æ³•å¯ä»¥ç”¨æ¥çŒœæµ‹å­—ç¬¦ä¸²æ˜¯å¦ä¼šè¢«é©»ç•™:
  - æ‰€æœ‰é•¿åº¦ä¸º 0 å’Œé•¿åº¦ä¸º 1 çš„å­—ç¬¦ä¸²éƒ½è¢«é©»ç•™.
  - å­—ç¬¦ä¸²åœ¨ç¼–è¯‘æ—¶è¢«å®ç° (`'wtf'` å°†è¢«é©»ç•™, ä½†æ˜¯ `''.join(['w', 't', 'f']` å°†ä¸ä¼šè¢«é©»ç•™)
  - å­—ç¬¦ä¸²ä¸­åªåŒ…å«å­—æ¯ï¼Œæ•°å­—æˆ–ä¸‹åˆ’çº¿æ—¶å°†ä¼šé©»ç•™. æ‰€ä»¥ `'wtf!'` ç”±äºåŒ…å« `!` è€Œæœªè¢«é©»ç•™.
- å½“åœ¨åŒä¸€è¡Œå°† `a` å’Œ `b` çš„å€¼è®¾ç½®ä¸º `"wtf!"` çš„æ—¶å€™, Python è§£é‡Šå™¨ä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡, ç„¶ååŒæ—¶å¼•ç”¨ç¬¬äºŒä¸ªå˜é‡. å¦‚æœä½ åœ¨ä¸åŒçš„è¡Œä¸Šè¿›è¡Œèµ‹å€¼æ“ä½œ, å®ƒå°±ä¸ä¼šâ€œçŸ¥é“â€å·²ç»æœ‰ä¸€ä¸ª `wtfï¼` å¯¹è±¡ (å› ä¸º `"wtf!"` ä¸æ˜¯æŒ‰ç…§ä¸Šé¢æåˆ°çš„æ–¹å¼è¢«éšå¼é©»ç•™çš„). å®ƒæ˜¯ä¸€ç§ç¼–è¯‘å™¨ä¼˜åŒ–, ç‰¹åˆ«é€‚ç”¨äºäº¤äº’å¼ç¯å¢ƒ.
- å¸¸é‡æŠ˜å (constant folding) æ˜¯ Python ä¸­çš„ä¸€ç§ [çª¥å­”ä¼˜åŒ–(peephole optimization)](https://en.wikipedia.org/wiki/Peephole_optimization) æŠ€æœ¯. è¿™æ„å‘³ç€åœ¨ç¼–è¯‘æ—¶è¡¨è¾¾å¼ `'a'*20` ä¼šè¢«æ›¿æ¢ä¸º `'aaaaaaaaaaaaaaaaaaaa'` ä»¥å‡å°‘è¿è¡Œæ—¶çš„æ—¶é’Ÿå‘¨æœŸ. åªæœ‰é•¿åº¦å°äº 20 çš„å­—ç¬¦ä¸²æ‰ä¼šå‘ç”Ÿå¸¸é‡æŠ˜å .

## Time for some hash brownies!/æ˜¯æ—¶å€™æ¥ç‚¹è›‹ç³•äº†
* hash brownieæŒ‡ä¸€ç§å«æœ‰å¤§éº»æˆåˆ†çš„è›‹ç³•, æ‰€ä»¥è¿™é‡Œæ˜¯å¥åŒå…³

1\.
``` Python
some_dict = {}
some_dict[5.5] = "Ruby"
some_dict[5.0] = "JavaScript"
some_dict[5] = "Python"
```

**Output:**
``` Python
>>> some_dict[5.5]
"Ruby"
>>> some_dict[5.0]
"Python"
>>> some_dict[5]
"Python"
```

"Python" æ¶ˆé™¤äº† "JavaScript" çš„å­˜åœ¨?

### è¯´æ˜:

* Python å­—å…¸é€šè¿‡æ£€æŸ¥é”®å€¼æ˜¯å¦ç›¸ç­‰å’Œæ¯”è¾ƒå“ˆå¸Œå€¼æ¥ç¡®å®šä¸¤ä¸ªé”®æ˜¯å¦ç›¸åŒ.
* å…·æœ‰ç›¸åŒå€¼çš„ä¸å¯å˜å¯¹è±¡åœ¨Pythonä¸­å§‹ç»ˆå…·æœ‰ç›¸åŒçš„å“ˆå¸Œå€¼.
  ``` Python
  >>> 5 == 5.0
  True
  >>> hash(5) == hash(5.0)
  True
  ```
  **æ³¨æ„:** å…·æœ‰ä¸åŒå€¼çš„å¯¹è±¡ä¹Ÿå¯èƒ½å…·æœ‰ç›¸åŒçš„å“ˆå¸Œå€¼ï¼ˆå“ˆå¸Œå†²çªï¼‰.
* å½“æ‰§è¡Œ `some_dict[5] = "Python"` è¯­å¥æ—¶, å› ä¸ºPythonå°† `5` å’Œ `5.0` è¯†åˆ«ä¸º `some_dict` çš„åŒä¸€ä¸ªé”®, æ‰€ä»¥å·²æœ‰å€¼ "JavaScript" å°±è¢« "Python" è¦†ç›–äº†.
* è¿™ä¸ª StackOverflowçš„ [å›ç­”](https://stackoverflow.com/a/32211042/4354153) æ¼‚äº®çš„è§£é‡Šäº†è¿™èƒŒåçš„åŸºæœ¬åŸç†.

## Return return everywhere!/åˆ°å¤„è¿”å›

``` Python
def some_func():
    try:
        return 'from_try'
    finally:
        return 'from_finally'
```

**Output:**
``` Python
>>> some_func()
'from_finally'
```

### è¯´æ˜:

- å½“åœ¨ "try...finally" è¯­å¥çš„ `try` ä¸­æ‰§è¡Œ `return`, `break` æˆ– `continue` å, `finally` å­å¥ä¾ç„¶ä¼šæ‰§è¡Œ.
- å‡½æ•°çš„è¿”å›å€¼ç”±æœ€åæ‰§è¡Œçš„ `return` è¯­å¥å†³å®š. ç”±äº `finally` å­å¥ä¸€å®šä¼šæ‰§è¡Œ, æ‰€ä»¥ `finally` å­å¥ä¸­çš„ `return` å°†å§‹ç»ˆæ˜¯æœ€åæ‰§è¡Œçš„è¯­å¥.

## For what?/ä¸ºä»€ä¹ˆ?

``` Python
some_string = "wtf"
some_dict = {}
for i, some_dict[i] in enumerate(some_string):
    pass
```

**Output:**
``` Python
>>> some_dict # åˆ›å»ºäº†ç´¢å¼•å­—å…¸.
{0: 'w', 1: 't', 2: 'f'}
```

### è¯´æ˜:
* [Python è¯­æ³•](https://docs.python.org/3/reference/grammar.html) ä¸­å¯¹ `for` çš„å®šä¹‰æ˜¯:
  ``` Python
  for_stmt: 'for' exprlist 'in' testlist ':' suite ['else' ':' suite]
  ```
  å…¶ä¸­ `exprlist` æŒ‡åˆ†é…ç›®æ ‡. è¿™æ„å‘³ç€å¯¹å¯è¿­ä»£å¯¹è±¡ä¸­çš„**æ¯ä¸€é¡¹éƒ½ä¼šæ‰§è¡Œ**ç±»ä¼¼ `{exprlist} = {next_value}` çš„æ“ä½œ.

  ä¸€ä¸ªæœ‰è¶£çš„ä¾‹å­è¯´æ˜äº†è¿™ä¸€ç‚¹:
  ``` Python
  for i in range(4):
      print(i)
      i = 10
  ```

  **Output:**
  ```
  0
  1
  2
  3
  ```

  ä½ å¯æ›¾è§‰å¾—è¿™ä¸ªå¾ªç¯åªä¼šè¿è¡Œä¸€æ¬¡?

  **è¯´æ˜:**
  - ç”±äºå¾ªç¯åœ¨Pythonä¸­å·¥ä½œæ–¹å¼, èµ‹å€¼è¯­å¥ `i = 10` å¹¶ä¸ä¼šå½±å“è¿­ä»£å¾ªç¯, åœ¨æ¯æ¬¡è¿­ä»£å¼€å§‹ä¹‹å‰, è¿­ä»£å™¨(è¿™é‡ŒæŒ‡ `range(4)`) ç”Ÿæˆçš„ä¸‹ä¸€ä¸ªå…ƒç´ å°±è¢«è§£åŒ…å¹¶èµ‹å€¼ç»™ç›®æ ‡åˆ—è¡¨çš„å˜é‡(è¿™é‡ŒæŒ‡ `i`)äº†.

* åœ¨æ¯ä¸€æ¬¡çš„è¿­ä»£ä¸­, `enumerate(some_string)` å‡½æ•°å°±ç”Ÿæˆä¸€ä¸ªæ–°å€¼ `i` (è®¡æ•°å™¨å¢åŠ ) å¹¶ä» `some_string` ä¸­è·å–ä¸€ä¸ªå­—ç¬¦. ç„¶åå°†å­—å…¸ `some_dict` é”® `i` (åˆšåˆšåˆ†é…çš„) çš„å€¼è®¾ä¸ºè¯¥å­—ç¬¦. æœ¬ä¾‹ä¸­å¾ªç¯çš„å±•å¼€å¯ä»¥ç®€åŒ–ä¸º:
  ``` Python
  >>> i, some_dict[i] = (0, 'w')
  >>> i, some_dict[i] = (1, 't')
  >>> i, some_dict[i] = (2, 'f')
  >>> some_dict
  ```

## `is` is not what it is!/å‡ºäººæ„æ–™çš„`is`!

ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨äº’è”ç½‘ä¸Šéå¸¸æœ‰åçš„ä¾‹å­.

``` Python
>>> a = 256
>>> b = 256
>>> a is b
True

>>> a = 257
>>> b = 257
>>> a is b
False

>>> a = 257; b = 257
>>> a is b
True
```

### è¯´æ˜:

**`is` å’Œ `==` çš„åŒºåˆ«**

* `is` è¿ç®—ç¬¦æ£€æŸ¥ä¸¤ä¸ªè¿ç®—å¯¹è±¡æ˜¯å¦å¼•ç”¨è‡ªåŒä¸€å¯¹è±¡ (å³, å®ƒæ£€æŸ¥ä¸¤ä¸ªé¢„ç®—å¯¹è±¡æ˜¯å¦ç›¸åŒ).
* `==` è¿ç®—ç¬¦æ¯”è¾ƒä¸¤ä¸ªè¿ç®—å¯¹è±¡çš„å€¼æ˜¯å¦ç›¸ç­‰.
* å› æ­¤ `is` ä»£è¡¨å¼•ç”¨ç›¸åŒ, `==` ä»£è¡¨å€¼ç›¸ç­‰. ä¸‹é¢çš„ä¾‹å­å¯ä»¥å¾ˆå¥½çš„è¯´æ˜è¿™ç‚¹
  ``` Python
  >>> [] == []
  True
  >>> [] is [] # è¿™ä¸¤ä¸ªç©ºåˆ—è¡¨ä½äºä¸åŒçš„å†…å­˜åœ°å€.
  False
  ```

**`256` æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡, è€Œ `257` ä¸æ˜¯**

å½“ä½ å¯åŠ¨Python çš„æ—¶å€™, `-5` åˆ° `256` çš„æ•°å€¼å°±å·²ç»è¢«åˆ†é…å¥½äº†. è¿™äº›æ•°å­—å› ä¸ºç»å¸¸ä½¿ç”¨æ‰€ä»¥é€‚åˆè¢«æå‰å‡†å¤‡å¥½.

å¼•ç”¨è‡ª https://docs.python.org/3/c-api/long.html
> å½“å‰çš„å®ç°ä¸º-5åˆ°256ä¹‹é—´çš„æ‰€æœ‰æ•´æ•°ä¿ç•™ä¸€ä¸ªæ•´æ•°å¯¹è±¡æ•°ç»„, å½“ä½ åˆ›å»ºäº†ä¸€ä¸ªè¯¥èŒƒå›´å†…çš„æ•´æ•°æ—¶, ä½ åªéœ€è¦è¿”å›ç°æœ‰å¯¹è±¡çš„å¼•ç”¨. æ‰€ä»¥æ”¹å˜1çš„å€¼æ˜¯æœ‰å¯èƒ½çš„. æˆ‘æ€€ç–‘è¿™ç§è¡Œä¸ºåœ¨Pythonä¸­æ˜¯æœªå®šä¹‰è¡Œä¸º. :-)

``` Python
>>> id(256)
10922528
>>> a = 256
>>> b = 256
>>> id(a)
10922528
>>> id(b)
10922528
>>> id(257)
140084850247312
>>> x = 257
>>> y = 257
>>> id(x)
140084850247440
>>> id(y)
140084850247344
```

è¿™é‡Œè§£é‡Šå™¨å¹¶æ²¡æœ‰æ™ºèƒ½åˆ°èƒ½åœ¨æ‰§è¡Œ `y = 257` æ—¶æ„è¯†åˆ°æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ•´æ•° `257`, æ‰€ä»¥å®ƒåœ¨å†…å­˜ä¸­åˆæ–°å»ºäº†å¦ä¸€ä¸ªå¯¹è±¡.

**å½“ `a` å’Œ `b` åœ¨åŒä¸€è¡Œä¸­ä½¿ç”¨ç›¸åŒçš„å€¼åˆå§‹åŒ–æ—¶ï¼Œä¼šæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡.**

``` Python
>>> a, b = 257, 257
>>> id(a)
140640774013296
>>> id(b)
140640774013296
>>> a = 257
>>> b = 257
>>> id(a)
140640774013392
>>> id(b)
140640774013488
```

* å½“ a å’Œ b åœ¨åŒä¸€è¡Œä¸­è¢«è®¾ç½®ä¸º `257` æ—¶, Python è§£é‡Šå™¨ä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡, ç„¶ååŒæ—¶å¼•ç”¨ç¬¬äºŒä¸ªå˜é‡. å¦‚æœä½ åœ¨ä¸åŒçš„è¡Œä¸Šè¿›è¡Œ, å®ƒå°±ä¸ä¼š "çŸ¥é“" å·²ç»å­˜åœ¨ä¸€ä¸ª `257` å¯¹è±¡äº†.
* è¿™æ˜¯ä¸€ç§ç‰¹åˆ«ä¸ºäº¤äº’å¼ç¯å¢ƒåšçš„ç¼–è¯‘å™¨ä¼˜åŒ–. å½“ä½ åœ¨å®æ—¶è§£é‡Šå™¨ä¸­è¾“å…¥ä¸¤è¡Œçš„æ—¶å€™, ä»–ä»¬ä¼šå•ç‹¬ç¼–è¯‘, å› æ­¤ä¹Ÿä¼šå•ç‹¬è¿›è¡Œä¼˜åŒ–. å¦‚æœä½ åœ¨ `.py` æ–‡ä»¶ä¸­å°è¯•è¿™ä¸ªä¾‹å­, åˆ™ä¸ä¼šçœ‹åˆ°ç›¸åŒçš„è¡Œä¸º, å› ä¸ºæ–‡ä»¶æ˜¯ä¸€æ¬¡æ€§ç¼–è¯‘çš„.

**è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ä¼šå½±å“è¡¨è¾¾å¼çš„æ±‚å€¼é¡ºåº, è€Œåœ¨ Python ä¸­ `==` è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§è¦é«˜äº `not` è¿ç®—ç¬¦.**

## Half triple-quoted strings/ä¸‰ä¸ªå¼•å·

**Output:**
``` Python
>>> print('wtfpython''')
wtfpython
>>> print("wtfpython""")
wtfpython
>>> # ä¸‹é¢çš„è¯­å¥ä¼šæŠ›å‡º `SyntaxError` å¼‚å¸¸
>>> # print('''wtfpython')
>>> # print("""wtfpython")
```

### è¯´æ˜:
+ Python æä¾›éšå¼çš„[å­—ç¬¦ä¸²é“¾æ¥](https://docs.python.org/2/reference/lexical_analysis.html#string-literal-concatenation)

  ``` Python
  >>> print("wtf" "python")
  wtfpython
  >>> print("wtf" "") # or "wtf"""
  wtf
  ```
+ `'''` å’Œ `"""` åœ¨ Pythonä¸­ä¹Ÿæ˜¯å­—ç¬¦ä¸²å®šç•Œç¬¦, Python è§£é‡Šå™¨åœ¨å…ˆé‡åˆ°ä¸‰ä¸ªå¼•å·çš„çš„æ—¶å€™ä¼šå°è¯•å†å¯»æ‰¾ä¸‰ä¸ªç»ˆæ­¢å¼•å·ä½œä¸ºå®šç•Œç¬¦, å¦‚æœä¸å­˜åœ¨åˆ™ä¼šå¯¼è‡´ `SyntaxError` å¼‚å¸¸.

## What's wrong with booleans?/å¸ƒå°”ä½ å’‹äº†?

1\.
``` Python
# ä¸€ä¸ªç®€å•çš„ä¾‹å­, ç»Ÿè®¡ä¸‹é¢å¯è¿­ä»£å¯¹è±¡ä¸­çš„å¸ƒå°”å‹å€¼çš„ä¸ªæ•°å’Œæ•´å‹å€¼çš„ä¸ªæ•°
mixed_list = [False, 1.0, "some_string", 3, True, [], False]
integers_found_so_far = 0
booleans_found_so_far = 0

for item in mixed_list:
    if isinstance(item, int):
        integers_found_so_far += 1
    elif isinstance(item, bool):
        booleans_found_so_far += 1
```

**Output:**
``` Python
>>> integers_found_so_far
4
>>> booleans_found_so_far
0
```

2\.
``` Python
another_dict = {}
another_dict[True] = "JavaScript"
another_dict[1] = "Ruby"
another_dict[1.0] = "Python"
```

**Output:**
``` Python
>>> another_dict[True]
"Python"
```

3\.
``` Python
>>> some_bool = True
>>> "wtf"*some_bool
'wtf'
>>> some_bool = False
>>> "wtf"*some_bool
''
```

### è¯´æ˜:

* å¸ƒå°”å€¼æ˜¯ `int` çš„å­ç±»
  ``` Python
  >>> isinstance(True, int)
  True
  >>> isinstance(False, int)
  True
  ```

* æ‰€ä»¥ `True` çš„æ•´æ•°å€¼æ˜¯ `1`, è€Œ `False` çš„æ•´æ•°å€¼æ˜¯ `0`.
  ``` Python
  >>> True == 1 == 1.0 and False == 0 == 0.0
  True
  ```
* å…³äºå…¶èƒŒåçš„åŸç†, è¯·çœ‹è¿™ä¸ª StackOverflow çš„[å›ç­”](https://stackoverflow.com/a/8169049/4354153).

## Class attributes and instance attributes/ç±»å±æ€§å’Œå®ä¾‹å±æ€§

1\.
``` Python
class A:
    x = 1

class B(A):
    pass

class C(A):
    pass
```

**Output:**
``` Python
>>> A.x, B.x, C.x
(1, 1, 1)
>>> B.x = 2
>>> A.x, B.x, C.x
(1, 2, 1)
>>> A.x = 3
>>> A.x, B.x, C.x
(3, 2, 3)
>>> a = A()
>>> a.x, A.x
(3, 3)
>>> a.x += 1
>>> a.x, A.x
(4, 3)
```

2\.
``` Python
class SomeClass:
    some_var = 15
    some_list = [5]
    another_list = [5]
    def __init__(self, x):
        self.some_var = x + 1
        self.some_list = self.some_list + [x]
        self.another_list += [x]
```

**Output:**

``` Python
>>> some_obj = SomeClass(420)
>>> some_obj.some_list
[5, 420]
>>> some_obj.another_list
[5, 420]
>>> another_obj = SomeClass(111)
>>> another_obj.some_list
[5, 111]
>>> another_obj.another_list
[5, 420, 111]
>>> another_obj.another_list is SomeClass.another_list
True
>>> another_obj.another_list is some_obj.another_list
True
```

### è¯´æ˜:

* ç±»å˜é‡å’Œå®ä¾‹å˜é‡åœ¨å†…éƒ¨æ˜¯é€šè¿‡ç±»å¯¹è±¡çš„å­—å…¸æ¥å¤„ç†(è¯‘: å°±æ˜¯ `__dict__` å±æ€§). å¦‚æœåœ¨å½“å‰ç±»çš„å­—å…¸ä¸­æ‰¾ä¸åˆ°çš„è¯å°±å»å®ƒçš„çˆ¶ç±»ä¸­å¯»æ‰¾.
* `+=` è¿ç®—ç¬¦ä¼šåœ¨åŸåœ°ä¿®æ”¹å¯å˜å¯¹è±¡, è€Œä¸æ˜¯åˆ›å»ºæ–°å¯¹è±¡. å› æ­¤, ä¿®æ”¹ä¸€ä¸ªå®ä¾‹çš„å±æ€§ä¼šå½±å“å…¶ä»–å®ä¾‹å’Œç±»å±æ€§.

## Mutating the immutable!/å¼ºäººæ‰€éš¾

``` Python
some_tuple = ("A", "tuple", "with", "values")
another_tuple = ([1, 2], [3, 4], [5, 6])
```

**Output:**
``` Python
>>> some_tuple[2] = "change this"
TypeError: 'tuple' object does not support item assignment
>>> another_tuple[2].append(1000) # è¿™é‡Œä¸å‡ºç°é”™è¯¯
>>> another_tuple
([1, 2], [3, 4], [5, 6, 1000])
>>> another_tuple[2] += [99, 999]
TypeError: 'tuple' object does not support item assignment
>>> another_tuple
([1, 2], [3, 4], [5, 6, 1000, 99, 999])
```

æˆ‘è¿˜ä»¥ä¸ºå…ƒç»„æ˜¯ä¸å¯å˜çš„å‘¢...

### è¯´æ˜:

* å¼•ç”¨ https://docs.python.org/2/reference/datamodel.html

    > ä¸å¯å˜åºåˆ—
        ä¸å¯å˜åºåˆ—çš„å¯¹è±¡ä¸€æ—¦åˆ›å»ºå°±ä¸èƒ½å†æ”¹å˜. (å¦‚æœå¯¹è±¡åŒ…å«å¯¹å…¶ä»–å¯¹è±¡çš„å¼•ç”¨ï¼Œåˆ™è¿™äº›å…¶ä»–å¯¹è±¡å¯èƒ½æ˜¯å¯å˜çš„å¹¶ä¸”å¯èƒ½ä¼šè¢«ä¿®æ”¹; ä½†æ˜¯ï¼Œç”±ä¸å¯å˜å¯¹è±¡ç›´æ¥å¼•ç”¨çš„å¯¹è±¡é›†åˆä¸èƒ½æ›´æ”¹.)

* `+=` æ“ä½œç¬¦åœ¨åŸåœ°ä¿®æ”¹äº†åˆ—è¡¨. å…ƒç´ èµ‹å€¼æ“ä½œå¹¶ä¸å·¥ä½œ, ä½†æ˜¯å½“å¼‚å¸¸æŠ›å‡ºæ—¶, å…ƒç´ å·²ç»åœ¨åŸåœ°è¢«ä¿®æ”¹äº†.

(è¯‘: å¯¹äºä¸å¯å˜å¯¹è±¡, è¿™é‡ŒæŒ‡tuple, `+=` å¹¶ä¸æ˜¯åŸå­æ“ä½œ, è€Œæ˜¯ `extend` å’Œ `=` ä¸¤ä¸ªåŠ¨ä½œ, è¿™é‡Œ `=` æ“ä½œè™½ç„¶ä¼šæŠ›å‡ºå¼‚å¸¸, ä½† `extend` æ“ä½œå·²ç»ä¿®æ”¹æˆåŠŸäº†. è¯¦ç»†è§£é‡Šå¯ä»¥çœ‹[è¿™é‡Œ](https://segmentfault.com/a/1190000010767068)ï¼‰


## From filled to None in one instruction.../ä»æœ‰åˆ°æ— ...

``` Python
some_list = [1, 2, 3]
some_dict = {
  "key_1": 1,
  "key_2": 2,
  "key_3": 3
}

some_list = some_list.append(4)
some_dict = some_dict.update({"key_4": 4})
```

**Output:**
``` Python
>>> print(some_list)
None
>>> print(some_dict)
None
```

### è¯´æ˜:

å¤§å¤šæ•°ä¿®æ”¹åºåˆ—/æ˜ å°„å¯¹è±¡çš„æ–¹æ³•, æ¯”å¦‚ `list.append`, `dict.update`, `list.sort` ç­‰ç­‰. éƒ½æ˜¯åŸåœ°ä¿®æ”¹å¯¹è±¡å¹¶è¿”å› `None`. è¿™æ ·åšçš„ç†ç”±æ˜¯, å¦‚æœæ“ä½œå¯ä»¥åŸåœ°å®Œæˆ, å°±å¯ä»¥é¿å…åˆ›å»ºå¯¹è±¡çš„å‰¯æœ¬æ¥æé«˜æ€§èƒ½. (å‚è€ƒ[è¿™é‡Œ](http://docs.python.org/2/faq/design.html#why-doesn-t-list-sort-return-the-sorted-list))


## Modifying a dictionary while iterating over it/è¿­ä»£å­—å…¸æ—¶çš„ä¿®æ”¹

``` Python
x = {0: None}

for i in x:
    del x[i]
    x[i+1] = None
    print(i)
```

**Output (Python 2.7- Python 3.5):**

```
0
1
2
3
4
5
6
7
```

æ˜¯çš„, å®ƒè¿è¡Œäº†**å…«æ¬¡**ç„¶åæ‰åœä¸‹æ¥.

### è¯´æ˜:

* Pythonä¸æ”¯æŒå¯¹å­—å…¸è¿›è¡Œè¿­ä»£çš„åŒæ—¶ä¿®æ”¹å®ƒ.
* å®ƒä¹‹æ‰€ä»¥è¿è¡Œ8æ¬¡, æ˜¯å› ä¸ºå­—å…¸ä¼šè‡ªåŠ¨æ‰©å®¹ä»¥å®¹çº³æ›´å¤šé”®å€¼(æˆ‘ä»¬æœ‰8æ¬¡åˆ é™¤è®°å½•, å› æ­¤éœ€è¦æ‰©å®¹). è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå®ç°ç»†èŠ‚. (è¯‘: åº”è¯¥æ˜¯å› ä¸ºå­—å…¸çš„åˆå§‹æœ€å°å€¼æ˜¯8, æ‰©å®¹ä¼šå¯¼è‡´æ•£åˆ—è¡¨åœ°å€å‘ç”Ÿå˜åŒ–è€Œä¸­æ–­å¾ªç¯.)
* åœ¨ä¸åŒçš„Pythonå®ç°ä¸­åˆ é™¤é”®çš„å¤„ç†æ–¹å¼ä»¥åŠè°ƒæ•´å¤§å°çš„æ—¶é—´å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒ.(è¯‘: å°±æ˜¯è¯´ä»€ä¹ˆæ—¶å€™æ‰©å®¹åœ¨ä¸åŒç‰ˆæœ¬ä¸­å¯èƒ½æ˜¯ä¸åŒçš„, åœ¨3.6åŠ3.7çš„ç‰ˆæœ¬ä¸­åˆ°[5](https://github.com/python/cpython/blob/v3.6.1/Objects/dictobject.c#L103-L110)å°±ä¼šè‡ªåŠ¨æ‰©å®¹äº†. ä»¥åä¹Ÿæœ‰å¯èƒ½å†æ¬¡å‘ç”Ÿå˜åŒ–. é¡ºå¸¦ä¸€æ,åé¢ä¸¤æ¬¡æ‰©å®¹ä¼šæ‰©å±•ä¸º32å’Œ256. 8->32->256)
* æ›´å¤šçš„ä¿¡æ¯, ä½ å¯ä»¥å‚è€ƒè¿™ä¸ªStackOverflowçš„[å›ç­”](https://stackoverflow.com/questions/44763802/bug-in-python-dict), å®ƒè¯¦ç»†çš„è§£é‡Šä¸€ä¸ªç±»ä¼¼çš„ä¾‹å­.

## Stubborn `del` operator/åšå¼ºçš„ `del` *

``` Python
class SomeClass:
    def __del__(self):
        print("Deleted!")
```

**Output:**
1\.
``` Python
>>> x = SomeClass()
>>> y = x
>>> del x # è¿™é‡Œåº”è¯¥ä¼šè¾“å‡º "Deleted!"
>>> del y
Deleted!
```

å”·, ç»ˆäºåˆ é™¤äº†. ä½ å¯èƒ½å·²ç»çŒœåˆ°äº†åœ¨æˆ‘ä»¬ç¬¬ä¸€æ¬¡å°è¯•åˆ é™¤ `x` æ—¶æ˜¯ä»€ä¹ˆè®© `__del__` å…äºè¢«è°ƒç”¨çš„. é‚£è®©æˆ‘ä»¬ç»™è¿™ä¸ªä¾‹å­å¢åŠ ç‚¹éš¾åº¦.

2\.
``` Python
>>> x = SomeClass()
>>> y = x
>>> del x
>>> y # æ£€æŸ¥ä¸€ä¸‹yæ˜¯å¦å­˜åœ¨
<__main__.SomeClass instance at 0x7f98a1a67fc8>
>>> del y # åƒä¹‹å‰ä¸€æ ·, è¿™é‡Œåº”è¯¥ä¼šè¾“å‡º "Deleted!"
>>> globals() # å¥½å§, å¹¶æ²¡æœ‰. è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ‰€æœ‰çš„å…¨å±€å˜é‡
Deleted!
{'__builtins__': <module '__builtin__' (built-in)>, 'SomeClass': <class __main__.SomeClass at 0x7f98a1a5f668>, '__package__': None, '__name__': '__main__', '__doc__': None}
```

å¥½äº†ï¼Œç°åœ¨å®ƒè¢«åˆ é™¤äº† :confused:

### è¯´æ˜:
+ `del x` å¹¶ä¸ä¼šç«‹åˆ»è°ƒç”¨ `x.__del__()`.
+ æ¯å½“é‡åˆ° `del x`, Python ä¼šå°† `x` çš„å¼•ç”¨æ•°å‡1, å½“ `x` çš„å¼•ç”¨æ•°å‡åˆ°0æ—¶å°±ä¼šè°ƒç”¨ `x.__del__()`.
+ åœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­, `y.__del__()` ä¹‹æ‰€ä»¥æœªè¢«è°ƒç”¨, æ˜¯å› ä¸ºå‰ä¸€æ¡è¯­å¥ (`>>> y`) å¯¹åŒä¸€å¯¹è±¡åˆ›å»ºäº†å¦ä¸€ä¸ªå¼•ç”¨, ä»è€Œé˜²æ­¢åœ¨æ‰§è¡Œ `del y` åå¯¹è±¡çš„å¼•ç”¨æ•°å˜ä¸º0.
+ è°ƒç”¨ `globals` å¯¼è‡´å¼•ç”¨è¢«é”€æ¯, å› æ­¤æˆ‘ä»¬å¯ä»¥çœ‹åˆ° "Deleted!" ç»ˆäºè¢«è¾“å‡ºäº†.
+ (è¯‘: è¿™å…¶å®æ˜¯ Python äº¤äº’è§£é‡Šå™¨çš„ç‰¹æ€§, å®ƒä¼šè‡ªåŠ¨è®© `_` ä¿å­˜ä¸Šä¸€ä¸ªè¡¨è¾¾å¼è¾“å‡ºçš„å€¼, è¯¦ç»†å¯ä»¥çœ‹[è¿™é‡Œ](https://www.cnblogs.com/leisurelylicht/p/diao-pi-de-kong-zhi-tai.html).)


## Deleting a list item while iterating/è¿­ä»£åˆ—è¡¨æ—¶åˆ é™¤å…ƒç´ 

``` Python
list_1 = [1, 2, 3, 4]
list_2 = [1, 2, 3, 4]
list_3 = [1, 2, 3, 4]
list_4 = [1, 2, 3, 4]

for idx, item in enumerate(list_1):
    del item

for idx, item in enumerate(list_2):
    list_2.remove(item)

for idx, item in enumerate(list_3[:]):
    list_3.remove(item)

for idx, item in enumerate(list_4):
    list_4.pop(idx)
```

**Output:**
``` Python
>>> list_1
[1, 2, 3, 4]
>>> list_2
[2, 4]
>>> list_3
[]
>>> list_4
[2, 4]
```

ä½ èƒ½çŒœåˆ°ä¸ºä»€ä¹ˆè¾“å‡ºæ˜¯ `[2, 4]` å—?

### è¯´æ˜:

* åœ¨è¿­ä»£æ—¶ä¿®æ”¹å¯¹è±¡æ˜¯ä¸€ä¸ªå¾ˆæ„šè ¢çš„ä¸»æ„. æ­£ç¡®çš„åšæ³•æ˜¯è¿­ä»£å¯¹è±¡çš„å‰¯æœ¬, `list_3[:]` å°±æ˜¯è¿™ä¹ˆåšçš„.

     ``` Python
     >>> some_list = [1, 2, 3, 4]
     >>> id(some_list)
     139798789457608
     >>> id(some_list[:]) # æ³¨æ„pythonä¸ºåˆ‡ç‰‡åˆ—è¡¨åˆ›å»ºäº†æ–°å¯¹è±¡.
     139798779601192
     ```

**`del`, `remove` å’Œ `pop` çš„ä¸åŒ:**
* `del var_name` åªæ˜¯ä»æœ¬åœ°æˆ–å…¨å±€å‘½åç©ºé—´ä¸­åˆ é™¤äº† `var_name` (è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ `list_1` æ²¡æœ‰å—åˆ°å½±å“).
* `remove` ä¼šåˆ é™¤ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„æŒ‡å®šå€¼, è€Œä¸æ˜¯ç‰¹å®šçš„ç´¢å¼•, å¦‚æœæ‰¾ä¸åˆ°å€¼åˆ™æŠ›å‡º `ValueError` å¼‚å¸¸.
* `pop` åˆ™ä¼šåˆ é™¤æŒ‡å®šç´¢å¼•å¤„çš„å…ƒç´ å¹¶è¿”å›å®ƒ, å¦‚æœæŒ‡å®šäº†æ— æ•ˆçš„ç´¢å¼•åˆ™æŠ›å‡º `IndexError` å¼‚å¸¸.

**ä¸ºä»€ä¹ˆè¾“å‡ºæ˜¯ `[2, 4]`?**
- åˆ—è¡¨è¿­ä»£æ˜¯æŒ‰ç´¢å¼•è¿›è¡Œçš„, æ‰€ä»¥å½“æˆ‘ä»¬ä» `list_2` æˆ– `list_4` ä¸­åˆ é™¤ `1` æ—¶, åˆ—è¡¨çš„å†…å®¹å°±å˜æˆäº† `[2, 3, 4]`. å‰©ä½™å…ƒç´ ä¼šä¾æ¬¡ä½ç§», ä¹Ÿå°±æ˜¯è¯´, `2` çš„ç´¢å¼•ä¼šå˜ä¸º 0, `3` ä¼šå˜ä¸º 1. ç”±äºä¸‹ä¸€æ¬¡è¿­ä»£å°†è·å–ç´¢å¼•ä¸º 1 çš„å…ƒç´  (å³ `3`), å› æ­¤ `2` å°†è¢«å½»åº•çš„è·³è¿‡. ç±»ä¼¼çš„æƒ…å†µä¼šäº¤æ›¿å‘ç”Ÿåœ¨åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ ä¸Š.

* å‚è€ƒè¿™ä¸ªStackOverflowçš„[å›ç­”](https://stackoverflow.com/questions/45946228/what-happens-when-you-try-to-delete-a-list-element-while-iterating-over-it)æ¥è§£é‡Šè¿™ä¸ªä¾‹å­
* å…³äºPythonä¸­å­—å…¸çš„ç±»ä¼¼ä¾‹å­, å¯ä»¥å‚è€ƒè¿™ä¸ªStackoverflowçš„[å›ç­”](https://stackoverflow.com/questions/45877614/how-to-change-all-the-dictionary-keys-in-a-for-loop-with-d-items).


## Same operands, different story!/åŒäººä¸åŒå‘½!

1\.
``` Python
a = [1, 2, 3, 4]
b = a
a = a + [5, 6, 7, 8]
```

**Output:**
``` Python
>>> a
[1, 2, 3, 4, 5, 6, 7, 8]
>>> b
[1, 2, 3, 4]
```

2\.
``` Python
a = [1, 2, 3, 4]
b = a
a += [5, 6, 7, 8]
```

**Output:**
``` Python
>>> a
[1, 2, 3, 4, 5, 6, 7, 8]
>>> b
[1, 2, 3, 4, 5, 6, 7, 8]
```

### è¯´æ˜:

*  `a += b` å¹¶ä¸æ€»æ˜¯ä¸ `a = a + b` è¡¨ç°ç›¸åŒ. ç±»å®ç° *`op=`* è¿ç®—ç¬¦çš„æ–¹å¼ *ä¹Ÿè®¸* æ˜¯ä¸åŒçš„, åˆ—è¡¨å°±æ˜¯è¿™æ ·åšçš„.
* è¡¨è¾¾å¼ `a = a + [5,6,7,8]` ä¼šç”Ÿæˆä¸€ä¸ªæ–°åˆ—è¡¨, å¹¶è®© `a` å¼•ç”¨è¿™ä¸ªæ–°åˆ—è¡¨, åŒæ—¶ä¿æŒ `b` ä¸å˜.
* è¡¨è¾¾å¼ `a += [5,6,7,8]` å®é™…ä¸Šæ˜¯ä½¿ç”¨çš„æ˜¯ "extend" å‡½æ•°, æ‰€ä»¥ `a` å’Œ `b` ä»ç„¶æŒ‡å‘å·²è¢«ä¿®æ”¹çš„åŒä¸€åˆ—è¡¨.

## Needle in a Haystack/å¤§æµ·æé’ˆ

1\.
``` Python
x, y = (0, 1) if True else None, None
```

**Output:**
``` Python
>>> x, y  # æœŸæœ›çš„ç»“æœæ˜¯ (0, 1)
((0, 1), None)
```

å‡ ä¹æ¯ä¸ª Python ç¨‹åºå‘˜éƒ½é‡åˆ°è¿‡ç±»ä¼¼çš„æƒ…å†µ.

2\.
``` Python
t = ('one', 'two')
for i in t:
    print(i)

t = ('one')
for i in t:
    print(i)

t = ()
print(t)
```

**Output:**
``` Python
one
two
o
n
e
tuple()
```

### è¯´æ˜:
* å¯¹äº 1, æ­£ç¡®çš„è¯­å¥æ˜¯ `x, y = (0, 1) if True else (None, None)`.
* å¯¹äº 2, æ­£ç¡®çš„è¯­å¥æ˜¯ `t = ('one',)` æˆ–è€… `t = 'one',` (ç¼ºå°‘é€—å·) å¦åˆ™è§£é‡Šå™¨ä¼šè®¤ä¸º `t` æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸², å¹¶é€ä¸ªå­—ç¬¦å¯¹å…¶è¿›è¡Œè¿­ä»£.
* `()` æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ ‡è®°ï¼Œè¡¨ç¤ºç©ºå…ƒç»„.


## Yes, it exists!/æ˜¯çš„, å®ƒå­˜åœ¨!

**å¾ªç¯çš„ `else`.** ä¸€ä¸ªå…¸å‹çš„ä¾‹å­:

``` Python
  def does_exists_num(l, to_find):
      for num in l:
          if num == to_find:
              print("Exists!")
              break
      else:
          print("Does not exist")
```

**Output:**
``` Python
>>> some_list = [1, 2, 3, 4, 5]
>>> does_exists_num(some_list, 4)
Exists!
>>> does_exists_num(some_list, -1)
Does not exist
```

**å¼‚å¸¸çš„ `else` .** ä¾‹,

``` Python
try:
    pass
except:
    print("Exception occurred!!!")
else:
    print("Try block executed successfully...")
```

**Output:**
``` Python
Try block executed successfully...
```

### è¯´æ˜:
- å¾ªç¯åçš„ `else` å­å¥åªä¼šåœ¨å¾ªç¯æ²¡æœ‰è§¦å‘ `break` è¯­å¥, æ­£å¸¸ç»“æŸçš„æƒ…å†µä¸‹æ‰ä¼šæ‰§è¡Œ.
- try ä¹‹åçš„ `else` å­å¥ä¹Ÿè¢«ç§°ä¸º "å®Œæˆå­å¥", å› ä¸ºåœ¨ `try` è¯­å¥ä¸­åˆ°è¾¾ `else` å­å¥æ„å‘³ç€tryå—å®é™…ä¸Šå·²æˆåŠŸå®Œæˆ.


## `+=` is faster/æ›´å¿«çš„ `+=`

``` Python
# ç”¨ "+" è¿æ¥ä¸‰ä¸ªå­—ç¬¦ä¸²:
>>> timeit.timeit("s1 = s1 + s2 + s3", setup="s1 = ' ' * 100000; s2 = ' ' * 100000; s3 = ' ' * 100000", number=100)
0.25748300552368164
# ç”¨ "+=" è¿æ¥ä¸‰ä¸ªå­—ç¬¦ä¸²:
>>> timeit.timeit("s1 += s2 + s3", setup="s1 = ' ' * 100000; s2 = ' ' * 100000; s3 = ' ' * 100000", number=100)
0.012188911437988281
```

### è¯´æ˜:
+ è¿æ¥ä¸¤ä¸ªä»¥ä¸Šçš„å­—ç¬¦ä¸²æ—¶ `+=` æ¯” `+` æ›´å¿«, å› ä¸ºåœ¨è®¡ç®—è¿‡ç¨‹ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸² (ä¾‹å¦‚, `s1 += s2 + s3` ä¸­çš„ `s1`) ä¸ä¼šè¢«é”€æ¯.(è¯‘: å°±æ˜¯ `+=` æ‰§è¡Œçš„æ˜¯è¿½åŠ æ“ä½œï¼Œå°‘äº†ä¸€ä¸ªé”€æ¯æ–°å»ºçš„åŠ¨ä½œ.)


## Let's make a giant string!/æ¥åšä¸ªå·¨å¤§çš„å­—ç¬¦ä¸²å§ï¼

``` Python
def add_string_with_plus(iters):
    s = ""
    for i in range(iters):
        s += "xyz"
    assert len(s) == 3*iters

def add_bytes_with_plus(iters):
    s = b""
    for i in range(iters):
        s += b"xyz"
    assert len(s) == 3*iters

def add_string_with_format(iters):
    fs = "{}"*iters
    s = fs.format(*(["xyz"]*iters))
    assert len(s) == 3*iters

def add_string_with_join(iters):
    l = []
    for i in range(iters):
        l.append("xyz")
    s = "".join(l)
    assert len(s) == 3*iters

def convert_list_to_string(l, iters):
    s = "".join(l)
    assert len(s) == 3*iters
```

**Output:**
``` Python
>>> timeit(add_string_with_plus(10000))
1000 loops, best of 3: 972 Âµs per loop
>>> timeit(add_bytes_with_plus(10000))
1000 loops, best of 3: 815 Âµs per loop
>>> timeit(add_string_with_format(10000))
1000 loops, best of 3: 508 Âµs per loop
>>> timeit(add_string_with_join(10000))
1000 loops, best of 3: 878 Âµs per loop
>>> l = ["xyz"]*10000
>>> timeit(convert_list_to_string(l, 10000))
10000 loops, best of 3: 80 Âµs per loop
```

è®©æˆ‘ä»¬å°†è¿­ä»£æ¬¡æ•°å¢åŠ 10å€.

``` Python
>>> timeit(add_string_with_plus(100000)) # æ‰§è¡Œæ—¶é—´çº¿æ€§å¢åŠ 
100 loops, best of 3: 9.75 ms per loop
>>> timeit(add_bytes_with_plus(100000)) # äºŒæ¬¡å¢åŠ 
1000 loops, best of 3: 974 ms per loop
>>> timeit(add_string_with_format(100000)) # çº¿æ€§å¢åŠ 
100 loops, best of 3: 5.25 ms per loop
>>> timeit(add_string_with_join(100000)) # çº¿æ€§å¢åŠ 
100 loops, best of 3: 9.85 ms per loop
>>> l = ["xyz"]*100000
>>> timeit(convert_list_to_string(l, 100000)) # çº¿æ€§å¢åŠ 
1000 loops, best of 3: 723 Âµs per loop
```

#### ğŸ’¡ è¯´æ˜:
- ä½ å¯ä»¥åœ¨è¿™è·å¾—æ›´å¤š [timeit](https://docs.python.org/3/library/timeit.html) çš„ç›¸å…³ä¿¡æ¯. å®ƒé€šå¸¸ç”¨äºè¡¡é‡ä»£ç ç‰‡æ®µçš„æ‰§è¡Œæ—¶é—´.
- ä¸è¦ç”¨ `+` å»ç”Ÿæˆè¿‡é•¿çš„å­—ç¬¦ä¸², åœ¨ Python ä¸­, `str` æ˜¯ä¸å¯å˜å¾—, æ‰€ä»¥åœ¨æ¯æ¬¡è¿æ¥ä¸­ä½ éƒ½è¦æŠŠå·¦å³ä¸¤ä¸ªå­—ç¬¦ä¸²å¤åˆ¶åˆ°æ–°çš„å­—ç¬¦ä¸²ä¸­. å¦‚æœä½ è¿æ¥å››ä¸ªé•¿åº¦ä¸º10çš„å­—ç¬¦ä¸², ä½ éœ€è¦æ‹·è´ (10+10) + ((10+10)+10) + (((10+10)+10)+10) = 90 ä¸ªå­—ç¬¦è€Œä¸æ˜¯ 40 ä¸ªå­—ç¬¦. éšç€å­—ç¬¦ä¸²çš„æ•°é‡å’Œå¤§å°çš„å¢åŠ , æƒ…å†µä¼šå˜å¾—è¶Šå‘çš„ç³Ÿç³• (å°±åƒ`add_bytes_with_plus` å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ä¸€æ ·)
- å› æ­¤, æ›´å»ºè®®ä½¿ç”¨ `.format.` æˆ– `%` è¯­æ³• (ä½†æ˜¯, å¯¹äºçŸ­å­—ç¬¦ä¸², å®ƒä»¬æ¯” `+` ç¨æ…¢ä¸€ç‚¹).
- åˆæˆ–è€…, å¦‚æœä½ æ‰€éœ€çš„å†…å®¹å·²ç»ä»¥å¯è¿­ä»£å¯¹è±¡çš„å½¢å¼æä¾›äº†, ä½¿ç”¨ `''.join(å¯è¿­ä»£å¯¹è±¡)` è¦å¿«å¤šäº†.
- `add_string_with_plus` çš„æ‰§è¡Œæ—¶é—´æ²¡æœ‰åƒ `add_bytes_with_plus` ä¸€æ ·å‡ºç°äºŒæ¬¡å¢åŠ æ˜¯å› ä¸ºè§£é‡Šå™¨ä¼šå¦‚åŒä¸Šä¸€ä¸ªåˆ—å­æ‰€è®¨è®ºçš„ä¸€æ ·ä¼˜åŒ– `+=`. ç”¨ `s = s + "x" + "y" + "z"` æ›¿ä»£ `s += "xyz"` çš„è¯, æ‰§è¡Œæ—¶é—´å°±ä¼šäºŒæ¬¡å¢åŠ äº†.

  ``` Python
  def add_string_with_plus(iters):
      s = ""
      for i in range(iters):
          s = s + "x" + "y" + "z"
      assert len(s) == 3*iters

  >>> timeit(add_string_with_plus(10000))
  100 loops, best of 3: 9.87 ms per loop
  >>> timeit(add_string_with_plus(100000)) # æ‰§è¡Œæ—¶é—´äºŒæ¬¡å¢åŠ 
  1 loops, best of 3: 1.09 s per loop
  ```
  

## Explicit typecast of strings/å­—ç¬¦ä¸²çš„æ˜¾å¼ç±»å‹è½¬æ¢

``` Python
a = float('inf')
b = float('nan')
c = float('-iNf')  # è¿™äº›å­—ç¬¦ä¸²ä¸åŒºåˆ†å¤§å°å†™
d = float('nan')
```

**Output:**

``` Python
>>> a
inf
>>> b
nan
>>> c
-inf
>>> float('some_other_string')
ValueError: could not convert string to float: some_other_string
>>> a == -c #inf==inf
True
>>> None == None # None==None
True
>>> b == d #ä½†æ˜¯ nan!=nan
False
>>> 50/a
0.0
>>> a/a
nan
>>> 23 + b
nan
```

### è¯´æ˜:

`'inf'` å’Œ `'nan'` æ˜¯ç‰¹æ®Šçš„å­—ç¬¦ä¸²(ä¸åŒºåˆ†å¤§å°å†™), å½“æ˜¾ç¤ºè½¬æ¢æˆ `float` å‹æ—¶, å®ƒä»¬åˆ†åˆ«ç”¨äºè¡¨ç¤ºæ•°å­¦æ„ä¹‰ä¸Šçš„ "æ— ç©·å¤§" å’Œ "éæ•°å­—".


## Minor Ones/å°çŸ¥è¯†ç‚¹

* `join()` æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ“ä½œè€Œä¸æ˜¯åˆ—è¡¨æ“ä½œ. (ç¬¬ä¸€æ¬¡æ¥è§¦ä¼šè§‰å¾—æœ‰ç‚¹è¿åç›´è§‰)

  **ğŸ’¡ è¯´æ˜:**
  å¦‚æœ `join()` æ˜¯å­—ç¬¦ä¸²æ–¹æ³• é‚£ä¹ˆå®ƒå°±å¯ä»¥å¤„ç†ä»»ä½•å¯è¿­ä»£çš„å¯¹è±¡(åˆ—è¡¨ï¼Œå…ƒç»„ï¼Œè¿­ä»£å™¨). å¦‚æœå®ƒæ˜¯åˆ—è¡¨æ–¹æ³•, åˆ™å¿…é¡»åœ¨æ¯ç§ç±»å‹ä¸­å•ç‹¬å®ç°. å¦å¤–, åœ¨ `list` å¯¹è±¡çš„é€šç”¨APIä¸­å®ç°ä¸€ä¸ªä¸“ç”¨äºå­—ç¬¦ä¸²çš„æ–¹æ³•æ²¡æœ‰å¤ªå¤§çš„æ„ä¹‰.

* çœ‹ç€å¥‡æ€ªä½†èƒ½æ­£ç¡®è¿è¡Œçš„è¯­å¥:
  + `[] = ()` è¯­å¥åœ¨è¯­ä¹‰ä¸Šæ˜¯æ­£ç¡®çš„ (è§£åŒ…ä¸€ä¸ªç©ºçš„ `tuple` å¹¶èµ‹å€¼ç»™ `list`)
  + `'a'[0][0][0][0][0]` åœ¨è¯­ä¹‰ä¸Šä¹Ÿæ˜¯æ­£ç¡®çš„, å› ä¸ºåœ¨ Python ä¸­å­—ç¬¦ä¸²åŒæ—¶ä¹Ÿæ˜¯[åºåˆ—](https://docs.python.org/3/glossary.html#term-sequence)(å¯è¿­ä»£å¯¹è±¡æ”¯æŒä½¿ç”¨æ•´æ•°ç´¢å¼•è®¿é—®å…ƒç´ ).
  + `3 --0-- 5 == 8` å’Œ `--5 == 5` åœ¨è¯­ä¹‰ä¸Šéƒ½æ˜¯æ­£ç¡®çš„, ä¸”ç»“æœç­‰äº `True`.(è¯‘: 3å‡è´Ÿ0ç­‰äº3ï¼Œå†å‡è´Ÿ5ç›¸å½“äºåŠ 5ç­‰äº8ï¼›è´Ÿçš„è´Ÿ5ç­‰äº5.)

* é‰´äº `a` æ˜¯ä¸€ä¸ªæ•°ç»„, `++a` å’Œ `--a` éƒ½æ˜¯æœ‰æ•ˆçš„ Python è¯­å¥, ä½†å…¶æ•ˆæœä¸ C, C++ æˆ– Java ç­‰ä¸ä¸€æ ·.
  ``` Python
  >>> a = 5
  >>> a
  5
  >>> ++a
  5
  >>> --a
  5
  ```

  **ğŸ’¡ è¯´æ˜:**
  + python é‡Œæ²¡æœ‰ `++` æ“ä½œç¬¦. è¿™å…¶å®æ˜¯ä¸¤ä¸ª `+` æ“ä½œç¬¦.
  + `++a` è¢«è§£æä¸º `+(+a)` æœ€åç­‰äº `a`. `--a` åŒç†.
  + è¿™ä¸ª StackOverflow [å›ç­”](https://stackoverflow.com/questions/3654830/why-are-there-no-and-operators-in-python) è®¨è®ºäº†ä¸ºä»€ä¹ˆ Python ä¸­ç¼ºå°‘å¢é‡å’Œå‡é‡è¿ç®—ç¬¦.

* Python ä½¿ç”¨ 2ä¸ªå­—èŠ‚å­˜å‚¨å‡½æ•°ä¸­çš„æœ¬åœ°å˜é‡. ç†è®ºä¸Š, è¿™æ„å‘³ç€å‡½æ•°ä¸­åªèƒ½å®šä¹‰65536ä¸ªå˜é‡. ä½†æ˜¯ï¼ŒPython å†…ç½®äº†ä¸€ä¸ªæ–¹ä¾¿çš„è§£å†³æ–¹æ¡ˆï¼Œå¯ç”¨äºå­˜å‚¨è¶…è¿‡2^16ä¸ªå˜é‡å. ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å½“å®šä¹‰äº†è¶…è¿‡65536ä¸ªå±€éƒ¨å˜é‡æ—¶å †æ ˆä¸­å‘ç”Ÿçš„æƒ…å†µ (è­¦å‘Š: è¿™æ®µä»£ç ä¼šæ‰“å°å¤§çº¦2^18è¡Œæ–‡æœ¬, è¯·åšå¥½å‡†å¤‡!):
     ``` Python
     import dis
     exec("""
     def f():
         """ + """
         """.join(["X"+str(x)+"=" + str(x) for x in range(65539)]))

     f()

     print(dis.dis(f))
     ```

* ä½ çš„ *Python ä»£ç * å¹¶ä¸ä¼šå¤šçº¿ç¨‹åŒæ—¶è¿è¡Œ (æ˜¯çš„, ä½ æ²¡å¬é”™!). è™½ç„¶ä½ è§‰å¾—ä¼šäº§ç”Ÿå¤šä¸ªçº¿ç¨‹å¹¶è®©å®ƒä»¬åŒæ—¶æ‰§è¡Œä½ çš„ä»£ç , ä½†æ˜¯, ç”±äº [å…¨å±€è§£é‡Šé”](https://wiki.python.org/moin/GlobalInterpreterLock)çš„å­˜åœ¨, ä½ æ‰€åšçš„åªæ˜¯è®©ä½ çš„çº¿ç¨‹ä¾æ¬¡åœ¨åŒä¸€ä¸ªæ ¸å¿ƒä¸Šæ‰§è¡Œ. Python å¤šçº¿ç¨‹é€‚ç”¨äºIOå¯†é›†å‹çš„ä»»åŠ¡, ä½†å¦‚æœæƒ³è¦å¹¶è¡Œå¤„ç†CPUå¯†é›†å‹çš„ä»»åŠ¡, ä½ åº”è¯¥ä¼šæƒ³ä½¿ç”¨ [multiprocessing](https://docs.python.org/2/library/multiprocessing.html) æ¨¡å—.

* åˆ—è¡¨åˆ‡ç‰‡è¶…å‡ºç´¢å¼•è¾¹ç•Œè€Œä¸å¼•å‘ä»»ä½•é”™è¯¯
  ``` Python
  >>> some_list = [1, 2, 3, 4, 5]
  >>> some_list[111:]
  []
  ```

* `int('Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©')` åœ¨ Python 3 ä¸­ä¼šè¿”å› `123456789`. åœ¨ Python ä¸­, åè¿›åˆ¶å­—ç¬¦åŒ…æ‹¬æ•°å­—å­—ç¬¦, ä»¥åŠå¯ç”¨äºå½¢æˆåè¿›åˆ¶æ•°å­—çš„æ‰€æœ‰å­—ç¬¦, ä¾‹å¦‚: U+0660, ARABIC-INDIC DIGIT ZERO. è¿™æœ‰ä¸€ä¸ªå…³äºæ­¤çš„ [æœ‰è¶£æ•…äº‹](http://chris.improbable.org/2014/8/25/adventures-in-unicode-digits/).

* `'abc'.count('') == 4`. è¿™æœ‰ä¸€ä¸ª `count` æ–¹æ³•çš„ç›¸è¿‘å®ç°, èƒ½æ›´å¥½çš„è¯´æ˜é—®é¢˜
  ``` Python
  def count(s, sub):
      result = 0
      for i in range(len(s) + 1 - len(sub)):
          result += (s[i:i + len(sub)] == sub)
      return result
  ```
  è¿™ä¸ªè¡Œä¸ºæ˜¯ç”±äºç©ºå­ä¸²(`''`)ä¸åŸå§‹å­—ç¬¦ä¸²ä¸­é•¿åº¦ä¸º0çš„åˆ‡ç‰‡ç›¸åŒ¹é…å¯¼è‡´çš„.
